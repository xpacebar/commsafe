<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="Opeoluwa Akinuliola">
    <title>Community Safety Network - Homepage</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css')}}">
    <link rel="application/javascript" href="{{ url_for('static', filename='bootstrap/js/bootstrap.bundle.min.js')}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='external/external.css')}}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='animate.min.css')}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='fontawesome-free-6.5.1-web/css/all.css')}}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alumni+Sans:wght@300&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alumni+Sans:wght@700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Yanone+Kaffeesatz:wght@200&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC&display=swap" rel="stylesheet">
    <style type="text/css">
      /* *{
        border: 1px solid red
      } */
      /* *{
        border:none;
      } */

    </style>
</head>
<body class="bgcolor">
  <div class="container-fluid">
      <nav class="navbar navbar-dark bgcolor fixed-top">
        <div class="container-xl">
          <a class="navbar-brand brand_col" href="{{ url_for('userpage') }}">
            <img src="{{ url_for('static', filename='images/csn.png')}}" alt="Logo" width="28px" class="d-inline-block align-text-top">&nbsp;<span class="home_brand_text">CSN</span>
          </a>
          <ul class="nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="{{ url_for('userpage') }}" title="Home"><i class="fa-solid fa-house fa-lg" style="color: #02834f;"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{{ url_for('user_search_page')}}" title="Search"><i class="fa-solid fa-magnifying-glass fa-lg" style="color: #02834f;"></i></a>
            </li>
            <li class="nav-item d-none d-sm-none d-md-block">
                <a class="nav-link" href="{{ url_for('user_profile')}}" title="Profile"><i class="fa-regular fa-user fa-lg" style="color: #02834f;"></i></a>
              </li>
              <li class="nav-item">
                <a class=" nav-link btn" tabindex="0" role="button" data-bs-toggle="popover" data-bs-trigger="focus" data-bs-title="Dismissible popover" data-bs-content="And here's some amazing content. It's very engaging. Right?" title="Notifications"><i class="fa-regular fa-bell fa-lg position-relative" style="color: #02834f;"></i></a>
                <div class="txt">10</div>
              </li>
              <li class="nav-item">
                <a class="nav-link" href=" {{ url_for('user_message')}}" title="Messages"><i class="fa-regular fa-envelope fa-lg position-relative" style="color: #02834f;"></i></a>
                <div class="txt">27</div>
              </li>
          </ul>
          <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar" aria-label="Toggle navigation">
            <span class="bgcolor"><i class="fa-solid fa-arrow-right-arrow-left fa-bounce" style="color: #02834f;"></i></span>
          </button>
          <div class="offcanvas offcanvas-end bg-transparent " tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel">
            <div class="overlay">
              <div class="offcanvas-header">
                <h5 class="offcanvas-title display-4" id="offcanvasDarkNavbarLabel">Hello {{deets.user_fname|title }}!</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
              </div>
              <div class="offcanvas-body menu">
                <ul class="navbar-nav justify-content-end flex-grow-1 pe-3 user_nav">
                  <li><a class="dropdown-item" href="{{ url_for('user_profile')}}">Profile</a></li>
                  <li><a class="dropdown-item" href="{{ url_for('user_change_password') }}">Change Password</a></li>
                  <!-- <li><a class="dropdown-item" href="#">Premium Access</a></li> -->
                  <li><hr></li>
                  <li><a class="dropdown-item" href="/logout">Logout</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </nav>
              <div class="row justify-content-center pt-5">
                {% block left_content %}
                <div class="col-sm-3 scroll d-none d-sm-none d-md-block">
                  <div class="tab1 pt-3">
                    <!-- Most Pages on the side nav requires api/location services to function as developed-->

                    <div class="my-2"><a href="{{ url_for('user_comm_news')}}">Community News</a></div>
                    <div class="my-2"><a href="{{url_for('user_safety_alerts')}}">Safety Alerts</a></div>
                    <div class="my-2"><a href="{{ url_for('user_community_members')}}">Community Members</a></div>
                    <div class="my-2"><a href="{{ url_for('schools_nearby')}}">Schools Nearby</a></div>
                    <div class="my-2"><a href="{{ url_for('church_nearby')}}">Church Nearby</a></div>
                    <div class="my-2"><a href="{{ url_for('mosque_nearby')}}">Mosque Nearby</a></div>
                    <div class="my-2"><a href="{{ url_for('hospital_nearby')}}">Hospital Nearby</a></div>
                    <div class="my-2"><a href="{{ url_for('user_volunter_opp')}}">Volunteer Opportunities</a></div>
                    <div class="my-2"><a href="{{ url_for('user_community_forum')}}">Community Forums</a></div>
                    <div class="my-2"><a href="{{ url_for('neighbourhood_watch')}}">Neighbourhood Watch</a></div>
                    <div class="my-2"><a href="{{ url_for('community_feedback')}}">Community Feedback</a></div>
                  </div>
                </div>
                {% endblock left_content %}
                {% block otherpages %}
                <div class="col-sm-8 tab2 pt-5 scroll" style="border-right: 0.1px solid #02834f;">
                  <div>
                    {% if deets and deets.user_picture != None %}
                    <a href="#" ><img id="user_session_img" src="/static/profile_pictures/{{deets.user_picture}}" alt="mdo" width="60" height="60" class="position-relative id_pix"></a>
                    {% else %}
                        <a href="#" ><img id="user_session_img" src="/static/images/user.jpeg" alt="user" width="60" height="60" class="position-relative id_pix"></a>
                    {% endif %}
                  </div>
                  {% block othercontent %}
                  {% endblock othercontent %}
                </div>
                {% endblock otherpages %}
                {% block mid_content %}
                <div class="col-sm-5 tab2 pt-4 scroll">
                  <!--Post report input session-->
                  <div  class="row justify-content-center gap-2">
                    <div class="col-1">
                      <div>
                        {% if deets and deets.user_picture != None %}
                          <img id="user_img" src="/static/profile_pictures/{{deets.user_picture}}" width="60px" height="60px" alt="{{deets.user_fname}}">
                        {% else %}
                          <img id="user_img" src="/static/images/user.jpeg" width="60px" height="60px" alt="user">
                        {% endif %}
                      </div>
                    </div>
                    <div class="col-10">
                      <form action="" method="post" enctype="multipart/form-data">
                        <input type="hidden" id="csrf_token" name="csrf_token" value="{{csrf_token()}}">
                        <textarea name="report" cols="45" rows="3" placeholder="Select a category to post a report" class="form-control bgcolor text-light" autocomplete="off"></textarea>
                        <div class="row justify-content-between">
                          <div class="col-6 pt-1">
                            <input type="file" name="report_pic" id="report_pic" class="labelcol">
                          </div>
                          <div class="col-6">
                            <select name="category" id="category" class="bg-transparent night_post custom_border text-end">
                              <option value="">category</option>
                              {% for category in report_category %}
                              <option value="{{category.report_category_id}}">{{category.report_category_name}}</option>
                              {% endfor %}
                            </select> 
                          </div>
                        </div>
                        <div class="row">
                          <div class="form-check form-switch mt-2 me-4" id="post_button">
                            <div class="row justify-content-between">
                              <div class="col-4">
                                <input type="checkbox" class="btn-check" name="anonymous" id="btn-check-2-outlined" autocomplete="off">
                                <label class="btn btn-outline-success btn-sm" for="btn-check-2-outlined">Anonymous</label>
                              </div>
                              <div class="col-4">
                                <input type="submit" value="Post" class="btn btn-sm night_post_btn quick_report">
                              </div>
                            </div>
                          </div>

                        </div>
                  </form>
                </div>
                  <div class="recent_alerts"><h4 class="text-center">Recent Alerts</h4></div>
              </div>
              <!--End post report input session-->
              <!--Recent Updates Session-->
              {% for report in all_reports %}
              {% if report.report_file_name == None %}
              <hr style="color: aliceblue;">
              <div class="row justify-content-center gap-2 mb-3 report_container">
                <div class="col-11 overlay">
                  <div class="row">
                  <div class="col-1">
                  {% if report.report_hide_user == "on" %}
                  <div><img id="user_img" src="/static/images/user.jpeg" width="60px" height="60px" alt="Anonymous"></div>
                  {% elif report.report_user_deets.user_picture == None %}
                  <div><a href="/profile/{{report.report_user_id}}/"><img id="user_img" src="/static/images/user.jpeg" width="60px" height="60px" alt="{{ report.report_user_deets.user_fname }} {{ report.report_user_deets.user_lname }}"></a></div>
                  {% else %}
                  <div><a href="/profile/{{report.report_user_id}}/"><img id="user_img" src="/static/profile_pictures/{{report.report_user_deets.user_picture}}" width="60px" height="60px" alt="{{ report.report_user_deets.user_fname }} {{ report.report_user_deets.user_lname }}"></a></div>
                  {% endif %}
                  </div>
                  <div class="col-11" >
                    <div class="row d-flex justify-content-between">
                      <div class="col-6">
                        {% if report.report_hide_user == "on" %}
                        <p class="post_name_night">Anonymous</p>
                        {% else %}
                        <p class="post_name_night">{{ report.report_user_deets.user_fname|title }} {{ report.report_user_deets.user_lname|title }}</p>
                        {% endif %}
                      </div>
                      <div class="col-5 text-end">
                      <p class="post_date_col">{{ report.report_date }}</p>
                      </div>
                  </div>
                  <p class="content_night">{{ report.report_desc }}</p>
                    <div class="row d-flex justify-content-between">
                        <div class="col-7">
                          <p>
                            {% if report.report_id in user_likes %}
                            <button class="btn btn-sm btnlike liked" data-post-id="{{report.report_id}}" data-csrf="{{csrf_token()}}">Liked</button>
                            {% else %}
                            <button class="btn btn-sm btnlike like" data-post-id="{{report.report_id}}" data-csrf="{{csrf_token()}}">Like</button>
                            {% endif %}
                            <span class="like like_counter">{{ report_likes_count.get(report.report_id, 0) }}</span>
                            &nbsp;<a class="btn comment" data-bs-toggle="collapse" href="#multiCollapseExample{{ loop.index }}" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Comment&nbsp;&nbsp;<span>{{ comment_counts.get(report.report_id, 0) }}</span></a>
                          </p>
                        </div>
                        <div class="col-5 text-end">
                          <p class="post_cat">{{report.report_cat_deets.report_category_name}}</p>
                        </div>
                    </div>
                    <div class="row">
                      <div class="col-9">
                        <div class="collapse multi-collapse" id="multiCollapseExample{{ loop.index }}">
                          <div class="card card-body bgcolor col-11">
                            <!--Comment Section Starts Here-->
                            <div class="row comment_section">
                              <div class="col-12">
                                <input type="hidden" id="csrf_token" name="csrf_token" value="{{csrf_token()}}">
                                <input type="hidden" id="report_id" name="report_id" value="{{report.report_id}}">
                                <textarea class="bgcolor text-light" name="comment" id="comment" cols="22" rows="2"></textarea>
                              </div>
                              <div class="offset-5 col-3">
                                <button id="comment_btn" type="submit" class="btn btn-sm comment_btn">Comment</button>
                              </div>
                              {% if report_comments[report.report_id] %}
                              <div class="col-9 comment_header">Comment(s)</div>
                              <div class="col-12 text-light comment_notes scroll_comment">
                              {% for comment in report_comments[report.report_id] %}
                              <div class="col-9 my-3" style="border-top:1px solid #afbebc;border-bottom:1px solid #afbebc">
                                <p>{{comment.comment_user_deet.user_fname|title}} {{comment.comment_user_deet.user_lname|title}}</p>
                                <p>{{ comment.comment_desc }}</p>
                                <p class="text-end">{{ comment.comment_datetime }}</p>
                              </div>
                              {% endfor %}
                              </div>
                              {% endif %}
                            </div>
                              <!--Comment Section Ends Here-->
                          </div>
                        </div>
                      </div>
                    </div>
                    </div>
                  </div>
                </div>
              </div>
              {% else %}
              <!--Report has pic -->
              <hr style="color: aliceblue;">
              <div class="row justify-content-center gap-2 mb-3">
                <div class="col-11">
                  <div class="row">
                    <div class="col-1"> 
                      {% if report.report_hide_user == "on" %}
                      <div><img id="user_img" src="/static/images/user.jpeg" width="60px" height="60px" alt="Anonymous"></div>
                      {% elif report.report_user_deets.user_picture == None %}
                      <div><a href="/profile/{{report.report_user_id}}/"><img id="user_img" src="/static/images/user.jpeg" width="60px" height="60px" alt="{{ report.report_user_deets.user_fname }} {{ report.report_user_deets.user_lname }}"></a></div>
                      {% else %}
                      <div><a href="/profile/{{report.report_user_id}}/"><img id="user_img" src="/static/profile_pictures/{{report.report_user_deets.user_picture}}" width="60px" height="60px" alt="{{ report.report_user_deets.user_fname }} {{ report.report_user_deets.user_lname }}"></a></div>
                      {% endif %}
                    </div>
                    <div class="col-11">
                      <div class="card mb-3 bgcolor" style="max-width: 540px;">
                        <div class="row d-flex justify-content-between">
                          <div class="col-7">
                            {% if report.report_hide_user == "on" %}
                            <p class="post_name_night">Anonymous</p>
                            {% else %}
                            <p class="post_name_night">{{ report.report_user_deets.user_fname|title }} {{ report.report_user_deets.user_lname|title }}</p>
                            {% endif %}
                          </div>
                          <div class="col-5 text-end">
                          <p class="post_date_col">{{ report.report_date }}</p>
                          </div>
                      </div>
                        <div class="row g-0">
                          <div class="col-md-4">
                             <img src="/static/report_images/{{ report.report_file_name }}" class="img-fluid rounded-start" alt="...">
                          </div>
                          <div class="col-md-8">
                            <div class="card-body">
                              <p class="content_night">{{ report.report_desc }}</p>
                              <p class="card-text"><small class="post_date_col">{{report.report_cat_deets.report_category_name}}</small></p>
                              <div class="row d-flex justify-content-between">
                                <div>
                                  <p>
                                    {% if report.report_id in user_likes %}
                                    <button class="btn btn-sm btnlike liked" data-post-id="{{report.report_id}}" data-csrf="{{csrf_token()}}">Liked</button>
                                    {% else %}
                                    <button class="btn btn-sm btnlike like" data-post-id="{{report.report_id}}" data-csrf="{{csrf_token()}}">Like</button>
                                    {% endif %}
                                    <span class="like like_counter">{{ report_likes_count.get(report.report_id, 0) }}</span>
                                    &nbsp;<a class="btn comment" data-bs-toggle="collapse" href="#multiCollapseExample{{ loop.index }}" role="button" aria-expanded="false" aria-controls="multiCollapseExample1">Comment&nbsp;&nbsp;<span>{{ comment_counts.get(report.report_id, 0) }}</span></a>
                                  </p>
                                </div>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-9">
                            <div class="collapse multi-collapse" id="multiCollapseExample{{ loop.index }}">
                              <div class="card card-body bgcolor col-11">
                                <!--Comment Section Starts Here-->
                                <div class="row comment_section">
                                  <div class="col-12">
                                    <input type="hidden" id="csrf_token" name="csrf_token" value="{{csrf_token()}}">
                                    <input type="hidden" id="report_id" name="report_id" value="{{report.report_id}}">
                                    <textarea class="bgcolor text-light" name="comment" id="comment" cols="22" rows="2"></textarea>
                                  </div>
                                  <div class="offset-5 col-3">
                                    <button id="comment_btn" type="submit" class="btn btn-sm comment_btn">Comment</button>
                                  </div>
                                  {% if report_comments[report.report_id] %}
                                  <div class="col-9 comment_header">Comment(s)</div>
                                  <div class="col-12 text-light comment_notes scroll_comment">
                                  {% for comment in report_comments[report.report_id] %}
                                  <div class="col-9 my-3" style="border-top:1px solid #afbebc;border-bottom:1px solid #afbebc">
                                    <p>{{comment.comment_user_deet.user_fname|title}} {{comment.comment_user_deet.user_lname|title}}</p>
                                    <p>{{ comment.comment_desc }}</p>
                                    <p class="text-end">{{ comment.comment_datetime }}</p>
                                  </div>
                                  {% endfor %}
                                  </div>
                                  {% endif %}
                                </div>
                                  <!--Comment Section Ends Here-->
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
              <!-- end Report has pic -->
              {% endif %}
              {% endfor %} 


              <!--End Recent Updates Session-->
            </div>
            {% endblock mid_content %}
            {% block right_content %}
            <div class="col-sm-3 tab1 pt-3 scroll d-none d-sm-none d-md-block">
              {% with message = get_flashed_messages(with_categories=True) %}
              {% if message %}
              {% for cat, msg in message %}
              {% if cat == 'error' %}
                  <div class="alert alert-danger noround text-center">
                      {{ msg }}
                  </div>
              {% else %}
                  <div class="alert alert-info noround text-center">
                      {{ msg }}
                  </div>
              {% endif %}
              {% endfor %}
              {% endif %}
              {% endwith %}
              <div class="my-2"><a href=" {{url_for('user_emergency_services')}} ">Emergency Hotlines</a></div>
              <div>
                <ul style="list-style-type:none;">
                  <li><p class="info_night">Nigeria Police Force - 08033011052</p></li>
                  <li><p class="info_night">Lagos State Ambluance Services - 08097204158</p></li>
                  <li><p class="info_night">Lagos State Fire Services - 08023321770</p></li>
                </ul>
              </div>
              <div><!--Start Featured Services-->
                <div class="my-2"><a href="{{url_for('user_featured_services')}}">Featured Services</a></div>
                <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    {% for service in top_featured_services %}
                    {% if loop.index == 1 %}
                    <div class="carousel-item active" data-bs-interval="4000">
                      <div class="card bgcolor">
                        <img src="/static/featured_images/{{service.featured_img_file}}" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title info_night display-6">{{ service.featured_name }}</h5>
                          <p class="card-text info_night lead">{{ service.featured_desc }}</p>
                          <p class="card-text info_night lead">Phone No- {{ service.featured_phone }}</p>
                        </div>
                      </div>
                    </div>
                    {% else %}
                    <div class="carousel-item" data-bs-interval="4000">
                      <div class="card bgcolor">
                        <img src="/static/featured_images/{{service.featured_img_file}}" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title info_night display-6">{{ service.featured_name }}</h5>
                          <p class="card-text info_night lead">{{ service.featured_desc }}</p>
                          <p class="card-text info_night lead">Phone No - {{ service.featured_phone }}</p>
                        </div>
                      </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div> <!--End Featured Services-->

              <!--To work on dynamic view for events section-->

              <hr>
              <div class="my-2"><a href="{{url_for('user_upcoming_events')}}">Upcoming Events</a></div>
              <div class="card mb-2 bg-dark">
                <div class="card-body bgcolor">
                  <h5 class="card-title info_night">Card title</h5>
                  <p class="card-text info_night">With supporting text below as a natural lead-in to additional content.</p>
                </div>
              </div>
              <div class="card mb-2 bg-dark">
                <div class="card-body bgcolor">
                  <h5 class="card-title info_night">Card title</h5>
                  <p class="card-text info_night">With supporting text below as a natural lead-in to additional content.</p>
                </div>
              </div>
              <div class="card mb-2 bg-dark">
                <div class="card-body bgcolor">
                  <h5 class="card-title info_night">Card title</h5>
                  <p class="card-text info_night">With supporting text below as a natural lead-in to additional content.</p>
                </div>
              </div>
              <hr>
            </div>
            {% endblock right_content %}
          </div>
      </div>
      <script src="{{ url_for('static', filename='script/jquery.js')}}"></script>
      <script src="{{url_for('static', filename='external/external.js')}}"></script>
  {% block script %}
  {% endblock script %}
</body>
</html>